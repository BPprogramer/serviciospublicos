!function(){if(document.querySelector(".formulario")){const e=document.querySelector('.formulario [type="submit"]');e&&e.addEventListener("click",(function(e){setTimeout(()=>{e.target.disabled=!0,e.target.classList.add("formulario__submit--deshabilitado")},0)}))}}(),function(){const e=document.querySelector(".alerta__exito"),t=document.querySelector(".formulario");if(e){t.style.display="none",setTimeout(()=>{e.remove(),function(){const e=window.location.href;e.includes("/admin/usuarios/")&&(window.location.href="/admin/usuarios");e.includes("/admin/estratos/")&&(window.location.href="/admin/estratos");e.includes("/admin/registrados/")&&(window.location.href="/admin/registrados");e.includes("/admin/cajas/")&&(window.location.href="/admin/cajas");e.includes("/admin/contabilidad/terceros/")&&(window.location.href="/admin/contabilidad/terceros");e.includes("/admin/contabilidad/cuentas/")&&(window.location.href="/admin/contabilidad/cuentas");e.includes("/admin/contabilidad/bancos/")&&(window.location.href="/admin/contabilidad/bancos");e.includes("/admin/contabilidad/cuentas-bancarias/")&&(window.location.href="/admin/contabilidad/cuentas-bancarias");e.includes("/admin/contabilidad/egresos/")&&(window.location.href="/admin/contabilidad/egresos");e.includes("/admin/contabilidad/egresos-simples/")&&(window.location.href="/admin/contabilidad/egresos-simples");e.includes("/admin/contabilidad/consignaciones/")&&(window.location.href="/admin/contabilidad/consignaciones")}()},3e3)}}(),function(){if(document.querySelector("#caja")){document.querySelector("#efectivo_inicial").addEventListener("input",(function(e){!function(e){const t=e.target.value;let a=parseFloat(t.replace(/,/g,""));isNaN(a)&&(a="");const n=a.toLocaleString("en");e.target.value=n}(e)}))}}(),function(){if(document.querySelector("#tablaCajasPagos")){let e;const t=new URL(window.location),a=new URLSearchParams(t.search).get("id");document.querySelector("#tablaCajasPagos");Number.isInteger(parseInt(a))?($("#tablaCajasPagos").dataTable().fnDestroy(),e=$("#tablaCajasPagos").DataTable({ajax:"/api/cajas/pagos?id="+a,deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0})):window.location.href="/admin/cajas"}}(),function(){if(document.querySelector("#tablaCajas")){let t;function e(e){Swal.fire({title:"Esta Seguro de Cerrar esta Caja?",text:"Esta acción no se puede deshacer",icon:"warning",showDenyButton:!0,confirmButtonText:"Seguro",denyButtonText:"Cancelar"}).then(a=>{a.isConfirmed&&async function(e){const a=new FormData;a.append("id",e);try{const e="/api/cajas/cerrar",n=await fetch(e,{body:a,method:"POST"}),o=await n.json();if("success"==o.tipo){if("error"==o.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:o.mensaje});Swal.fire({icon:"success",text:o.mensaje}),t.ajax.reload()}}catch(e){console.log(e)}}(e)})}$("#tablaCajas").on("click","#estadoCaja",(function(t){e($(this).data("cajaId"))})),$("#tablaCajas").dataTable().fnDestroy(),t=$("#tablaCajas").DataTable({ajax:"/api/cajas",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),t.on("draw",(function(){const t=document.querySelector("#estadoCaja");t&&t.addEventListener("dblclick",(function(t){e(t.target.dataset.cajaId)}))}))}}(),function(){if(document.querySelector("#estrato")){const c=document.querySelector("#tarifa_plena"),i=document.querySelector("#porcentaje_subsidio"),r=document.querySelector("#subsidio"),s=document.querySelector("#copago"),l=document.querySelector("#porcentaje_acu"),d=document.querySelector("#subsidio_acu"),u=document.querySelector("#copago_acu"),p=document.querySelector("#tarifa_plena_acu"),m=document.querySelector("#porcentaje_alc"),f=document.querySelector("#subsidio_alc"),_=document.querySelector("#copago_alc"),g=document.querySelector("#tarifa_plena_alc"),b=document.querySelector("#porcentaje_aseo"),h=document.querySelector("#subsidio_aseo"),y=document.querySelector("#copago_aseo"),S=document.querySelector("#tarifa_plena_aseo"),C=document.querySelector("#ajuste"),v=document.querySelector("#porcentaje_ajuste");function e(e){const t=e.target.value;let a=parseFloat(t.replace(/,/g,""));isNaN(a)&&(a="");const n=a.toLocaleString("en");e.target.value=n}function t(){a(l.value/100,d,u,p),a(m.value/100,f,_,g),a(b.value/100,h,y,S)}function a(e,t,a,n){const r=c.value,s=i.value/100;if(""!=r&&s>=0&&e>=0){const c=parseFloat(r.replace(/,/g,""));o(c*s*e,1*(c*(1-s)*e).toFixed(2),t,a,n,(c*e).toLocaleString("en"))}else t.value=0,a.value=0,n.value=0}function n(){const e=c.value,t=parseFloat(i.value/100);if(""!=e&&t>=0){const a=parseFloat(e.replace(/,/g,""));o(a*t,1*(a*(1-t)).toFixed(2),r,s)}else r.value="",s.value=""}function o(e,t,a,n,o=[],c=""){""!=c&&(o.value=c);const i=e.toLocaleString("en"),r=t.toLocaleString("en");a.value=i,n.value=r}c.addEventListener("input",(function(a){e(a),n(),t(),C.value="",v.value=""})),i.addEventListener("input",(function(e){const a=parseFloat(e.target.value);(a<0||a>100)&&(e.target.value=""),n(),t(),C.value="",v.value=""})),l.addEventListener("input",(function(e){(1*e.target.value<0||1*e.target.value>100)&&(e.target.value="");a(e.target.value/100,d,u,p)})),m.addEventListener("input",(function(e){(1*e.target.value<0||1*e.target.value>100)&&(e.target.value="");a(e.target.value/100,f,_,g)})),b.addEventListener("input",(function(e){(1*e.target.value<0||1*e.target.value>100)&&(e.target.value="");a(e.target.value/100,h,y,S)})),v.addEventListener("input",(function(){(1*v.value<0||1*v.value>100)&&(v.value="");if(""!=s.value&&""!=v.value&&0!=s.value){const e=parseFloat(s.value.replace(/,/g,"")),t=(v.value/100*e).toFixed(2);C.value=parseFloat(t).toLocaleString("en")}else C.value="",v.value=""})),C.addEventListener("input",(function(t){!function(){if(""!=s.value&&""!=C.value&&0!=s.value){const e=parseFloat(C.value.replace(/,/g,"")),t=parseFloat(s.value.replace(/,/g,""));if(e>t)return C.value="",void(v.value="");const a=1*(100*e/t).toFixed(2);v.value=a}else C.value="",v.value=""}(),e(t)}))}}(),function(){if(document.querySelector("#tablaEstratos")){let a;function e(){document.querySelectorAll("#btn_info_estrato").forEach(e=>{e.addEventListener("click",(function(e){!async function(e){const t="/api/estratos/info?id="+e.currentTarget.dataset.estratoId;try{const e=await fetch(t),a=await e.json();if("error"==a.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:a.mensaje});!function(e){const t=document.createElement("DIV");t.classList.add("modal"),t.innerHTML=`\n                <div class="modal__informacion" id="info">\n                    <h3>Información del Estrato </h3>\n                    \n                    <ul class="modal__lista">\n                         <li class="modal__elemento modal__elemento--grid">\n                           \n                            <p class="modal__info">Estrato: <span>${e.estrato}</span></p>\n                            <p class="modal__info">Año Vigente: <span>${e.year}</span></p>\n                            <p class="modal__info">Tarifa Plena: <span>${parseFloat(e.tarifa_plena).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Número de Facturas Vencidas: <span>${e.facturas_vencidas}</span></p>\n        \n                         </li>\n                   \n\n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Subsidio: <span>${e.porcentaje_subsidio}%</span></p>\n                            <p class="modal__info">Porcentaje Copago: <span>${e.porcentaje_copago}%</span></p>\n                            <p class="modal__info">Subsidio: <span>${parseFloat(e.subsidio).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Copago: <span>${parseFloat(e.copago).toLocaleString("en")}</span></p>\n                         </li>\n                        \n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Acueducto: <span>${parseFloat(e.porcentaje_acu).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Acueducto: <span>${parseFloat(e.tarifa_plena_acu).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Subsidio Acueducto: <span>${parseFloat(e.subsidio_acu).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Copago Acueducto : <span>${parseFloat(e.copago_acu).toLocaleString("en")}</span></p>\n                         </li>\n                         \n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Alcantarillado: <span>${parseFloat(e.porcentaje_alc).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Alcantarillado: <span>${parseFloat(e.tarifa_plena_alc).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Subsidio Alcantarillado: <span>${parseFloat(e.subsidio_alc).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Copago Alcantarillado : <span>${parseFloat(e.copago_alc).toLocaleString("en")}</span></p>\n                         </li>\n                         \n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Aseo: <span>${parseFloat(e.porcentaje_aseo).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Aseo: <span>${parseFloat(e.tarifa_plena_aseo).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Subsidio Aseo: <span>${parseFloat(e.subsidio_aseo).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Copago Aseo : <span>${parseFloat(e.copago_aseo).toLocaleString("en")}</span></p>\n                         </li>\n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Ajuste: <span>${parseFloat(e.porcentaje_ajuste).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Ajuste: <span>${parseFloat(e.ajuste).toLocaleString("en")}</span></p>\n                           \n                         </li>\n                         \n                        \n                    </ul>\n\n                    <div class="modal__opciones">\n                      \n             \n                      \n                        <button type="button" class="modal__cerrar-modal">Cerrar</button>\n                    </div>\n                    \n                </div>\n            `,setTimeout(()=>{document.querySelector("#info").classList.add("modal__informacion--animar")},10),t.addEventListener("click",(function(e){if(e.preventDefault(),e.target.classList.contains("modal__cerrar-modal")){document.querySelector("#info").classList.add("modal__informacion--cerrar"),setTimeout(()=>{t.remove()},500)}})),document.querySelector(".dashboard__contenedor").appendChild(t)}(a)}catch(e){console.log(e)}}(e)}))});document.querySelectorAll("#btn_eliminar_estrato").forEach(e=>{e.addEventListener("click",(function(e){t(e)}))})}function t(e){const t=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.estratoId;Swal.fire({title:`Esta seguro que desea eliminar el estrato ${t}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){url="/api/estratos/eliminar?id="+e;try{const e=await fetch(url),t=await e.json();if("error"==t.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:t.mensaje});Swal.fire({icon:"success",text:t.mensaje}),a.ajax.reload()}catch(e){console.log(e)}}(n)})}$("#tablaEstratos").on("click","#btn_eliminar_estrato",(function(e){t(e)})),$("#tablaEstratos").dataTable().fnDestroy(),a=$("#tablaEstratos").DataTable({ajax:"/api/estratos",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),a.on("draw",e)}}(),function(){if(document.querySelector("#tablaEmitidasPendientes")){let e;$("#tablaEmitidasPendientes").dataTable().fnDestroy(),e=$("#tablaEmitidasPendientes").DataTable({ajax:"/api/emitidas",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),$("#tablaEmitidasPendientes").on("click","#btn_previsualizar",(function(e){!function(e){const t="/api/previsualizar-factura?key="+btoa(e);window.open(t,"_blank")}($(this).attr("data-numero-factura"))}))}}(),function(){const e=document.querySelector("#btnImprimirFacturas");if(e){const n=document.querySelector("#btnCuentasPorPagar"),o=document.querySelector("#switch"),c=document.querySelector("#btnGenerarFacturas");function t(){Swal.fire({title:"Esta seguro de generar las facturas de este mes?",showDenyButton:!0,confirmButtonText:"Generar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(){c.removeEventListener("click",t),c.classList.add("inicio__boton-generar--inactivo");try{const e=await fetch("/api/generar-facturas-manual"),a=await e.json();console.log(a),c.classList.remove("inicio__boton-generar--inactivo"),c.addEventListener("click",t),Swal.fire({icon:a.type,text:a.msg})}catch(e){console.log(e)}}()})}async function a(){try{const e=await fetch("/api/generar-auto"),n=await e.json();!function(e){const n=document.createElement("INPUT");n.type="checkbox",n.id="checkbox",c.classList.contains("inicio__boton-generar--inactivo")&&c.classList.remove("inicio__boton-generar--inactivo");1==e?(n.checked=!0,c.classList.add("inicio__boton-generar--inactivo"),c.removeEventListener("click",t)):(n.checked=!1,c.addEventListener("click",t));n.onchange=function(){setTimeout(()=>{!async function(e){let t;t=e?1:0;const n=new FormData;n.append("id",1),n.append("auto",t);try{await fetch("/api/generar-auto",{body:n,method:"POST"}),a()}catch(e){}}(n.checked)},300)};const i=document.createElement("DIV");i.classList.add("slider","round"),o.appendChild(n),o.appendChild(i)}(n.auto)}catch(e){console.log(e)}}document.querySelector("#btnEliminarFacturas").addEventListener("click",(function(){Swal.fire({title:"Esta seguro de generar las facturas de este mes?",showDenyButton:!0,confirmButtonText:"Eliminar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(){try{const e=await fetch("/api/eliminar-facturas"),t=await e.json();Swal.fire({icon:t.type,text:t.msg})}catch(e){}}()})})),a(),e.addEventListener("click",(function(){window.open("/api/facturas","_blank")})),n.addEventListener("click",(function(){console.log("asdf");window.open("/api/cuentas-por-cobrar","_blank")}))}}(),document.addEventListener("DOMContentLoaded",(function(){if(document.querySelector("#cajas")){const n=document.querySelector("#subscriptores"),o=document.querySelector("#subscriptoresVigentes"),c=document.querySelector("#subscriptoresInactivos"),i=document.querySelector("#pagosVigentes"),r=document.querySelector("#fecha"),s=document.querySelector("#ingreso"),l=document.querySelector("#ingresosMensuales"),d=document.querySelector("#totalPagos"),u=document.querySelector("#totalConsignaciones"),p=document.querySelector("#year"),m=document.querySelector("#mes"),f=document.querySelector("#year_consignacion"),_=document.querySelector("#mes_consignacion"),g=document.querySelector("#consignacionAseo"),b=document.querySelector("#consignacionAlc"),h=document.querySelector("#consignacionAcu"),y=document.querySelector("#total_del_mes"),S=document.querySelector("#ya_consignado"),C=document.querySelector("#a_consignar"),v=document.querySelector("#estratos"),w=document.querySelector("#btnImprimirFacturasFiltradas");function e(){!async function(e){const t=new FormData;t.append("fecha",e);try{const e=await fetch("/api/inicio/ingresos-mensuales",{body:t,method:"POST"}),a=await e.json();l.textContent="$"+a}catch(e){}}(p.value+"-"+m.value)}function t(){!async function(e){const t=new FormData;t.append("fecha",e);try{const e=await fetch("/api/inicio/consignaciones",{body:t,method:"POST"});!function(e){g.textContent="",h.textContent="",b.textContent="",y.textContent="",S.textContent="",C.textContent="",g.textContent="$"+(e.aseo||0),h.textContent="$"+(e.acueducto||0),b.textContent="$"+(e.alcantarillado||0),y.textContent="$"+(e.total_del_mes||0),S.textContent="$"+(e.ya_consignado||0),C.textContent="$"+(e.a_consignar||0)}(await e.json())}catch(e){}}(f.value+"-"+_.value)}async function a(e){const t=new FormData;t.append("fecha",e);try{const e=await fetch("/api/inicio/fecha",{body:t,method:"POST"});!function(e){s.textContent="$"+e}(await e.json())}catch(e){}}p.addEventListener("change",e),m.addEventListener("change",e),f.addEventListener("change",t),_.addEventListener("change",t),async function(){try{const e=await fetch("/api/inicio/registrados");!function(e){const{registrados:t,registrados_activos:a,registrados_inactivos:r,pagos_vigentes:s,ingresos:l,consignaciones:p}=e;n.textContent=t,o.textContent=a,c.textContent=r,i.textContent=s,d.textContent="$"+l,u.textContent="$"+p}(await e.json())}catch(e){}}(),function(){const e=(new Date).toISOString().slice(0,10);r.value=e,a(e)}(),e(),async function(){const e=location.origin+"/api/estratos-all";try{const t=await fetch(e),a=await t.json();a.forEach(e=>{const t=document.createElement("OPTION");t.value=e.id,t.textContent=e.estrato,v.appendChild(t)})}catch(e){console.log(e)}}(),w.addEventListener("click",(function(e){const t=v.value;if(0==t)Swal.fire({icon:"error",text:"Porfavor seleccione un estrato"});else{const e="/api/facturas?estratos-key="+btoa(t);window.open(e,"_blank")}})),r.addEventListener("change",(function(e){a(e.target.value)}))}})),function(){const e=document.querySelector("#tablaUsuarios");if(e){let n;function t(){document.querySelectorAll("#btn_eliminar_usuario").forEach(e=>{e.addEventListener("click",(function(e){a(e)}))})}function a(e){const t=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,a=e.currentTarget.dataset.usuarioId;Swal.fire({title:`Esta seguro que desea eliminar a  ${t}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){url="/api/usuarios/eliminar?id="+e;try{const e=await fetch(url),t=await e.json();if("error"==t.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:t.mensaje});Swal.fire({icon:"success",text:t.mensaje}),n.ajax.reload()}catch(e){console.log(e)}}(a)})}e.addEventListener("click",(function(e){!function(e){"btn_cambiar_estado"==e.target.id&&function(e){const t=e.target.dataset.estadoActual,a=e.target.parentNode.parentNode.children[1].textContent,o=e.target.dataset.usuarioId;let c="";c=1==t?"Esta seguro que desea desactivar a":"Esta seguro que desea activar a";Swal.fire({title:`${c}  ${a}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){url="/api/usuarios/editar-estado?id="+e;try{const e=await fetch(url),t=await e.json();if("error"==t.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:t.mensaje});Swal.fire({icon:"success",title:t.mensaje}),n.ajax.reload()}catch(e){console.log(e)}}(o)})}(e)}(e)})),$("#tablaUsuarios").on("click","#btn_eliminar_usuario",(function(e){a(e)})),$("#tablaUsuarios").dataTable().fnDestroy(),n=$("#tablaUsuarios").DataTable({ajax:"/api/usuarios",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),n.on("draw",t)}}(),function(){if(document.querySelector("#tablaPagos")){let e;$("#tablaPagos").dataTable().fnDestroy(),e=$("#tablaPagos").DataTable({ajax:"/api/lista-pagos",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),$("#tablaPagos").on("click","#btn_previsualizar",(function(e){!function(e){const t="/api/previsualizar-pago?key="+btoa(e);window.open(t,"_blank")}($(this).attr("data-numero-pago"))})),$("#tablaPagos").on("click","#btn_anular",(function(t){var a;a=$(this).attr("data-numero-pago"),Swal.fire({title:`Esta seguro que desea anular el pago # ${a}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(t){const a=new FormData;a.append("numero_pago",t);try{const t=await fetch("/api/anular-pago",{body:a,method:"POST"}),n=await t.json();if(console.log(n),"error"==n.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:n.mensaje});Swal.fire({icon:"success",text:n.mensaje}),e.ajax.reload()}catch(e){}}(a)})}))}}(),function(){if(document.querySelector("#contenedorPagar")){const t=document.querySelector("#numero_factura"),a=document.querySelector("#pagarFacturas"),n=document.querySelector("#guardarPagos"),o=document.querySelector("#totalFacturas"),c=document.querySelector("#totalRecaudo");let i,r=[];function e(){for(;a.firstChild;)a.removeChild(a.firstChild)}!async function(){try{const n=await fetch("/api/facturas-por-pagar"),s=await n.json();i=s,t.addEventListener("input",(function(n){!function(n){const s=n.target.value,l=i.find(e=>e.numero_factura===s);l&&(t.value="",function(t){if(r.find(e=>e.id===t.id))setTimeout(()=>{Swal.fire("Error","La Factura ya fue agregada a la fila de pagos","error")},1);else if(1==t.pagado)setTimeout(()=>{Swal.fire("Error","La Factura ya ha sido cancelada","error")},1);else if(1==t.combinado)setTimeout(()=>{Swal.fire("Error","La Factura ha sido combinada","error")},1);else if("TEMPORALES"==t.estrato)setTimeout(()=>{Swal.fire("Error","Estrato Temporales no admitido ","error")},1);else{Swal.fire({position:"top-end",icon:"success",title:"Factura agregada a la pila",showConfirmButton:!1,timer:1500});const{id:n,numero_factura:i,registrado_nombre:s,estrato:l,mes_facturado:d,copago:u,ajuste:p,saldo_anterior:m}=t;r.unshift({numero_factura:i,subscriptor:s,estrato:l,mes_facturado:d,copago:u,ajuste:p,saldo_anterior:m,id:n});const f=document.createElement("TABLE");f.classList.add("table"),e();let _=0,g=0;r.forEach(e=>{const{numero_factura:t,subscriptor:a,estrato:n,mes_facturado:o,copago:c,ajuste:i,saldo_anterior:r}=e,s=document.createElement("TR");s.classList.add("table__tr");const l=document.createElement("TD");l.classList.add("table__td"),l.textContent="#"+t;const d=document.createElement("TD");d.classList.add("table__td"),d.innerHTML='<span class="table__span">Cliente:&nbsp; </span>&nbsp; '+a;const u=document.createElement("TD");u.classList.add("table__td"),u.innerHTML='<span class="table__span">Estrato:&nbsp; </span>&nbsp; '+n;const p=document.createElement("TD");p.classList.add("table__td"),p.innerHTML='<span class="table__span">Mes Facturado:&nbsp; </span>&nbsp; '+o;let m=parseFloat(c)+parseFloat(r)-parseFloat(i);const b=document.createElement("TD");b.classList.add("table__td"),b.innerHTML=' <span class="table__span">Monto:&nbsp; </span>$ '+m.toLocaleString("en"),s.appendChild(l),s.appendChild(d),s.appendChild(u),s.appendChild(p),s.appendChild(b),f.appendChild(s),_+=m,g+=1}),o.textContent=g,c.textContent="$"+_.toLocaleString("en"),a.appendChild(f)}}(l))}(n)}))}catch(e){}}(),n.addEventListener("click",(function(){r.length>0?Swal.fire({title:`Esta seguro que desea subir ${o.textContent} Pagos por ${c.textContent}`,icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(){const t=new FormData,a=r.map(e=>e.id);t.append("pagos",JSON.stringify(a));try{const a=await fetch("/api/subir-pagos",{body:t,method:"POST"}),n=await a.json();"error"==n.tipo?Swal.fire({icon:"error",title:"Oops",text:n.mensaje}):(e(),o.textContent=0,c.textContent="$0",r=[],Swal.fire({icon:"success",text:n.mensaje}))}catch(e){}}()}):Swal.fire("Error","Debe agregar al menos una factura","error")}))}}(),function(){const e=document.querySelector("#facturas");if(e){const n=new URL(window.location),o=new URLSearchParams(n.search).get("id"),c=document.querySelector("#cliente");async function t(){const t=new FormData;t.append("id",o);try{const n="/api/facturas-registrado",o=await fetch(n,{method:"POST",body:t}),i=await o.json();i&&(function(e){const t=document.querySelector("#deuda");t.classList=[],t.classList.add("deuda__valor"),0==e?t.classList.add("deuda__valor--pagado"):t.classList.add("deuda__valor--vencido");t.textContent="$ "+e.toLocaleString("en")}(i.deuda),function(t){const n=document.createElement("TABLE");n.classList.add("table"),t.forEach(e=>{const{id:t,numero_factura:o,fecha_emision:i,periodo_fin:r,periodo_inicio:s,copago:l,pagado:d,ajuste:u,combinado:p,saldo_anterior:m}=e,f=(new Date).getMonth()+1,_=i.split("-"),g=f-parseFloat(_[1]),b=document.createElement("TR");b.classList.add("table__tr"),b.onclick=function(t){!function(e){const t=document.querySelector(".table__seleccion");t&&t.classList.remove("table__seleccion");e.currentTarget.classList.add("table__seleccion")}(t),function(e){const{id:t,numero_factura:n,fecha_emision:o,estrato:i,periodo_inicio:r,periodo_fin:s,copago:l,ajuste:d,pagado:u,saldo_anterior:p,combinado:m}=e;!function(){const e=document.querySelector("#actions");for(;e.firstChild;)e.removeChild(e.firstChild)}();const f=document.querySelector("#actions"),_=document.createElement("DIV");_.classList.add("actions__contenedor");document.createElement("DIV").classList.add("actions__info");const g=document.createElement("DIV");g.classList.add("registrado__datos");const b=document.createElement("SPAN");b.classList.add("registrado__label"),b.textContent="Cliente";const h=document.createElement("P");h.classList.add("registrado__dato"),h.textContent=c.textContent;const y=document.createElement("DIV");y.classList.add("registrado__datos");const S=document.createElement("SPAN");S.classList.add("registrado__label"),S.textContent="Estrato";const C=document.createElement("P");C.classList.add("registrado__dato"),C.textContent=i;const v=document.createElement("DIV");v.classList.add("registrado__datos");const w=document.createElement("SPAN");w.classList.add("registrado__label"),w.textContent="Periodo";const L=document.createElement("P");L.classList.add("registrado__dato"),L.innerHTML=`${r} &nbsp;- &nbsp;  ${s}`;const E=document.createElement("DIV");E.classList.add("registrado__datos");const x=document.createElement("SPAN");x.classList.add("registrado__label"),x.textContent="Monto ";const T=parseFloat(l)+parseFloat(p)-parseFloat(d),j=document.createElement("P");j.classList.add("registrado__dato"),j.textContent="$ "+T.toLocaleString("en"),g.appendChild(b),g.appendChild(h),y.appendChild(S),y.appendChild(C),v.appendChild(w),v.appendChild(L),E.appendChild(x),E.appendChild(j),_.appendChild(g),_.appendChild(y),_.appendChild(v),_.appendChild(E),f.appendChild(_);const q=document.createElement("DIV");q.classList.add("actions__botones");const $=document.createElement("SPAN");if($.classList.add("actions__boton"),$.onclick=function(){!async function(e){const t="/api/previsualizar-factura?key="+btoa(e);window.open(t,"_blank")}(n)},$.textContent="Previzualizar",0==u&&0==m){const t=document.createElement("SPAN");t.classList.add("actions__boton"),t.textContent="Pago Efectivo",t.id="btnPagar";const n=document.createElement("SPAN");n.classList.add("actions__boton"),n.textContent="transferencia",n.id="btnBanco",t.onclick=function(){n.style.display="none",t.style.display="none",a(e,1,t,n)},n.onclick=function(){n.style.display="none",t.style.display="none",a(e,0,t,n)},q.appendChild(t),q.appendChild(n)}q.appendChild($),f.appendChild(q)}(e)};const h=document.createElement("TD");h.classList.add("table__td"),h.textContent="#"+o;const y=document.createElement("TD");y.classList.add("table__td"),y.innerHTML='<span class="table__span">Emitida:&nbsp; </span>&nbsp; '+i;const S=document.createElement("TD");S.classList.add("table__td"),S.innerHTML=`<span class="table__span">Periodo:&nbsp; </span>&nbsp; ${s} &nbsp; - &nbsp;${r}`;const C=parseFloat(l)+parseFloat(m)-parseFloat(u),v=document.createElement("TD");v.classList.add("table__td"),v.innerHTML=' <span class="table__span">Monto:&nbsp; </span>$ '+parseFloat(C).toLocaleString("en");const w=document.createElement("TD");w.classList.add("table__td"),w.innerHTML=g>0&&0==d?' <span class="table__boton table__boton--vencida">Impaga</span>':` <span class="table__boton table__boton--${1==d?"pagado":"impaga"}">${1==d?"Pagado":"Impaga"}</span>`,1==p&&(w.innerHTML=' <span class="table__boton table__boton--vencida">Combinada</span>'),b.appendChild(h),b.appendChild(y),b.appendChild(S),b.appendChild(v),b.appendChild(w),n.appendChild(b)}),e.appendChild(n)}(i.facturas))}catch(e){console.log(e)}}function a(a,n,o,i){const{id:r,copago:s,periodo_inicio:l,periodo_fin:d,numero_factura:u}=a,p=document.createElement("DIV");p.classList.add("registrado");const m=document.createElement("DIV");m.classList.add("registrado__datos");const f=document.createElement("SPAN");f.classList.add("registrado__label"),f.textContent="Metodo de Pago:";const _=document.createElement("P");_.classList.add("registrado__dato"),_.textContent=1==n?"Efectivo":"Transferencia";const g=document.createElement("DIV");g.classList.add("registrado__datos");const b=document.createElement("SPAN");b.classList.add("registrado__label"),b.textContent="Cliente:";const h=document.createElement("P");h.classList.add("registrado__dato"),h.textContent=c.textContent;const y=document.createElement("DIV");y.classList.add("registrado__datos");const S=document.createElement("SPAN");S.classList.add("registrado__label"),S.textContent="Periodo:";const C=document.createElement("P");C.classList.add("registrado__dato"),C.innerHTML=`${l} &nbsp;- &nbsp;  ${d}`;const v=document.createElement("DIV");v.classList.add("registrado__datos");const w=document.createElement("SPAN");w.classList.add("registrado__label"),w.textContent="Monto: ";const L=document.createElement("P");L.classList.add("registrado__dato"),L.textContent="$ "+parseFloat(s).toLocaleString("en"),m.appendChild(f),m.appendChild(_),g.appendChild(b),g.appendChild(h),y.appendChild(S),y.appendChild(C),v.appendChild(w),v.appendChild(L),p.appendChild(m),p.appendChild(g),p.appendChild(y),p.appendChild(v),Swal.fire({title:"Confirme La información",html:p,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(a=>{a.isConfirmed?async function(a,n,o,c){const i=new FormData;i.append("id",a),i.append("metodo",n);try{const a=await fetch("/api/pagar",{body:i,method:"POST"}),n=await a.json();if("error"==n.tipo)Swal.fire({icon:"error",title:"Oops",text:n.mensaje});else{Swal.fire({icon:"success",text:n.mensaje});const a=document.querySelector("body"),o=document.createElement("input");for(o.type="hidden",o.id="confirmacionPago",a.appendChild(o);e.firstChild;)e.removeChild(e.firstChild);document.querySelector("#btnPagar").remove(),t()}}catch(e){}}(r,n):(o.style.display="block",i.style.display="block")})}t()}}(),function(){if(document.querySelector("#tablaRegistrados")){let a;function e(){document.querySelectorAll("#btn_eliminar_registrado").forEach(e=>{e.addEventListener("click",(function(e){t(e)}))})}function t(e){"btn_eliminar_registrado"==e.currentTarget.id&&function(e){const t=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.registradoId;Swal.fire({title:`Esta seguro que desea eliminar el estrato ${t}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){const t="/api/registrados/eliminar?id="+e;try{const e=await fetch(t),n=await e.json();if("error"==n.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:n.mensaje});Swal.fire({icon:"success",text:n.mensaje}),a.ajax.reload()}catch(e){console.log(e)}}(n)})}(e)}document.querySelector("#downloadUsersXlsx").addEventListener("click",(async function(){try{const a=await fetch("/api/registrados/download"),n=await a.json();console.log(n);var e=XLSX.utils.book_new(),t=XLSX.utils.json_to_sheet(n);XLSX.utils.book_append_sheet(e,t,"Datos"),XLSX.writeFile(e,"registrados.xlsx")}catch(e){console.log(e)}})),$("#tablaRegistrados").on("click","#btn_eliminar_registrado",(function(e){t(e)})),$("#tablaRegistrados").dataTable().fnDestroy(),a=$("#tablaRegistrados").DataTable({ajax:"/api/registrados",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),a.on("draw",e)}}(),function(){const e=document.querySelector("#pagos");if(e){const a=new URL(window.location),n=new URLSearchParams(a.search).get("id");document.querySelector("#cliente"),document.querySelector("#actions");async function t(){document.querySelector("#confirmacionPago")&&document.querySelector("#confirmacionPago").remove();const t=new FormData;t.append("id",n);try{const a="/api/pagos",n=await fetch(a,{method:"POST",body:t}),o=await n.json();o&&function(t){for(;e.firstChild;)e.removeChild(e.firstChild);const a=document.createElement("TABLE");a.classList.add("table"),t.forEach(e=>{const{id:t,numero_factura:n,fecha_pago:o,periodo_fin:c,periodo_inicio:i,monto:r,numero_pago:s,estado:l}=e,d=document.createElement("TR");d.classList.add("table__tr"),d.onclick=function(t){!function(e){const t=document.querySelector(".table__seleccion");t&&t.classList.remove("table__seleccion");e.currentTarget.classList.add("table__seleccion")}(t),function(e){const{id:t,numero_factura:a,numero_pago:n,estrato:o,metodo:c,periodo_inicio:i,periodo_fin:r,monto:s,recaudador:l,factura_id:d}=e;!function(){const e=document.querySelector("#payments");for(;e.firstChild;)e.removeChild(e.firstChild)}();const u=document.querySelector("#payments"),p=document.createElement("DIV");p.classList.add("actions__contenedor");document.createElement("DIV").classList.add("actions__info");const m=document.createElement("DIV");m.classList.add("registrado__datos");const f=document.createElement("SPAN");f.classList.add("registrado__label"),f.textContent="Recaudador";const _=document.createElement("P");_.classList.add("registrado__dato"),_.textContent=l;const g=document.createElement("DIV");g.classList.add("registrado__datos");const b=document.createElement("SPAN");b.classList.add("registrado__label"),b.textContent="Periodo";const h=document.createElement("P");h.classList.add("registrado__dato"),h.innerHTML=`${i} &nbsp;- &nbsp;  ${r}`;const y=document.createElement("DIV");y.classList.add("registrado__datos");const S=document.createElement("SPAN");S.classList.add("registrado__label"),S.textContent="Monto ";const C=document.createElement("P");C.classList.add("registrado__dato"),C.textContent="$ "+s;const v=document.createElement("DIV");v.classList.add("registrado__datos");const w=document.createElement("SPAN");w.classList.add("registrado__label"),w.textContent="Metodo ";const L=document.createElement("P");L.classList.add("registrado__dato"),L.textContent=1==c?"Efectivo":"Transferencia",m.appendChild(f),m.appendChild(_),g.appendChild(b),g.appendChild(h),y.appendChild(S),y.appendChild(C),v.appendChild(w),v.appendChild(L),p.appendChild(m),p.appendChild(g),p.appendChild(y),p.appendChild(v),u.appendChild(p);const E=document.createElement("DIV");E.classList.add("actions__botones");const x=document.createElement("SPAN");x.classList.add("actions__boton"),x.onclick=function(){!async function(e){const t="/api/previsualizar-pago?key="+btoa(e);window.open(t,"_blank")}(d)},x.textContent="Previzualizar",E.appendChild(x),u.appendChild(E)}(e)};const u=document.createElement("TD");u.classList.add("table__td"),u.textContent="#"+n;const p=document.createElement("TD");p.classList.add("table__td"),p.innerHTML='<span class="table__span">Fecha de Pago:&nbsp; </span>&nbsp; '+o;const m=document.createElement("TD");m.classList.add("table__td"),m.innerHTML=`<span class="table__span">Periodo:&nbsp; </span>&nbsp; ${i} &nbsp; - &nbsp;${c}`;const f=document.createElement("TD");f.classList.add("table__td"),f.innerHTML=' <span class="table__span">Monto:&nbsp; </span>$ '+r;const _=document.createElement("TD");if(_.classList.add("table__td"),_.innerHTML=' <span class="table__span">Pago #&nbsp; </span> '+s,d.appendChild(u),d.appendChild(p),d.appendChild(m),d.appendChild(f),d.appendChild(_),0==l){const e=document.createElement("TD");e.classList.add("table__td"),e.innerHTML='<span class="table__boton table__boton--vencida">Anulado</span>',d.appendChild(e)}a.appendChild(d)}),e.appendChild(a)}(o)}catch(e){console.log(e)}}document.querySelector("body").addEventListener("click",(function(){document.querySelector("#confirmacionPago")&&t()})),t()}}(),function(){if(document.querySelector("#tablaBancos")){let t;function e(){document.querySelectorAll("#btn_eliminar_banco").forEach(e=>{e.addEventListener("click",(function(e){!function(e){"btn_eliminar_banco"===e.currentTarget.id&&function(e){const a=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.bancoId;Swal.fire({title:`Eliminar banco ${a}?`,text:"Esta acción no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){const a="/api/contabilidad/bancos/eliminar?id="+e;try{const e=await fetch(a),n=await e.json();if("error"===n.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:n.mensaje});Swal.fire({icon:"success",text:n.mensaje}),t.ajax.reload()}catch(e){console.log(e)}}(n)})}(e)}(e)}))})}$("#tablaBancos").dataTable().fnDestroy(),t=$("#tablaBancos").DataTable({ajax:"/api/contabilidad/bancos",deferRender:!0,retrieve:!0,processing:!0,responsive:!0}),t.on("draw",e)}}(),function(){if(document.querySelector("#tablaCuentasBancarias")){let t;function e(){document.querySelectorAll("#btn_eliminar_cuenta_bancaria").forEach(e=>{e.addEventListener("click",(function(e){!function(e){"btn_eliminar_cuenta_bancaria"===e.currentTarget.id&&function(e){const a=e.currentTarget.parentNode.parentNode.parentNode.children[2].textContent,n=e.currentTarget.dataset.cuentaId;Swal.fire({title:`Eliminar cuenta bancaria ${a}?`,text:"Esta acción no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){const a="/api/contabilidad/cuentas_bancarias/eliminar?id="+e;try{const e=await fetch(a),n=await e.json();if("error"===n.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:n.mensaje});Swal.fire({icon:"success",text:n.mensaje}),t.ajax.reload()}catch(e){console.log(e)}}(n)})}(e)}(e)}))})}$("#tablaCuentasBancarias").dataTable().fnDestroy(),t=$("#tablaCuentasBancarias").DataTable({ajax:"/api/contabilidad/cuentas-bancarias",deferRender:!0,retrieve:!0,processing:!0,responsive:!0}),t.on("draw",e)}}(),function(){const e=document.querySelector("#movimientosCuenta");if(!e)return;const t=e.dataset.cuentaId,a=document.querySelector("#fecha_inicio"),n=document.querySelector("#fecha_fin"),o=document.querySelector("#btnFiltrarMovimientos"),c=document.querySelectorAll(".tab-btn"),i=document.querySelectorAll(".tab-content");c.forEach(e=>{e.addEventListener("click",(function(){c.forEach(e=>e.classList.remove("active")),i.forEach(e=>e.classList.remove("active")),this.classList.add("active"),document.getElementById(this.dataset.tab).classList.add("active")}))});const r=$("#tablaConsignacionesMov").DataTable({ajax:{url:"/api/contabilidad/movimientos/consignaciones",data:function(e){e.cuenta_id=t,e.fecha_inicio=a.value,e.fecha_fin=n.value}},processing:!0,responsive:!0,destroy:!0}),s=$("#tablaEgresosMov").DataTable({ajax:{url:"/api/contabilidad/movimientos/egresos",data:function(e){e.cuenta_id=t,e.fecha_inicio=a.value,e.fecha_fin=n.value}},processing:!0,responsive:!0,destroy:!0}),l=$("#tablaEgresosSimplesMov").DataTable({ajax:{url:"/api/contabilidad/movimientos/egresos-simples",data:function(e){e.cuenta_id=t,e.fecha_inicio=a.value,e.fecha_fin=n.value}},processing:!0,responsive:!0,destroy:!0});o.addEventListener("click",(function(){r.ajax.reload(),s.ajax.reload(),l.ajax.reload()}))}(),function(){if(document.querySelector("#tablaConsignaciones")){let t;function e(){document.querySelectorAll("#btn_anular_consignacion").forEach(e=>{e.addEventListener("click",(function(e){!function(e){const a=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.consignacionId;Swal.fire({title:`¿Desea anular la consignación del ${a}?`,text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceder",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&Swal.fire({title:"Razón de anulación",input:"textarea",inputLabel:"Ingrese la razón",inputPlaceholder:"Escriba la razón...",showCancelButton:!0,confirmButtonText:"Anular",cancelButtonText:"Cancelar",inputValidator:e=>{if(!e)return"La razón de anulación es obligatoria"}}).then(e=>{e.isConfirmed&&async function(e,a){try{const n=await fetch("/api/contabilidad/consignaciones/anular",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,razon_anulacion:a})}),o=await n.json();if("error"===o.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:o.mensaje});Swal.fire({icon:"success",text:o.mensaje}),t.ajax.reload()}catch(e){console.log(e)}}(n,e.value)})})}(e)}))})}$("#tablaConsignaciones").dataTable().fnDestroy(),t=$("#tablaConsignaciones").DataTable({ajax:"/api/contabilidad/consignaciones",deferRender:!0,retrieve:!0,processing:!0,responsive:!0}),t.on("draw",e)}}(),function(){if(document.querySelector("#tablaCuentas")){let t;function e(){document.querySelectorAll("#btn_eliminar_cuenta").forEach(e=>{e.addEventListener("click",(function(e){!function(e){"btn_eliminar_cuenta"===e.currentTarget.id&&function(e){const a=e.currentTarget.parentNode.parentNode.parentNode.children[2].textContent,n=e.currentTarget.dataset.cuentaId;Swal.fire({title:`Eliminar cuenta ${a}?`,text:"Esta acción no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){const a="/api/contabilidad/cuentas/eliminar?id="+e;try{const e=await fetch(a),n=await e.json();if("error"===n.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:n.mensaje});Swal.fire({icon:"success",text:n.mensaje}),t.ajax.reload()}catch(e){console.log(e)}}(n)})}(e)}(e)}))})}$("#tablaCuentas").dataTable().fnDestroy(),t=$("#tablaCuentas").DataTable({ajax:"/api/contabilidad/cuentas",deferRender:!0,retrieve:!0,processing:!0,responsive:!0}),t.on("draw",e)}}(),function(){const e=document.querySelector(".js-egreso-form");if(!e)return;const t=e.querySelector("#js-lineas-egreso"),a=e.querySelector(".js-agregar-linea"),n=e.querySelector(".js-cuenta-select");if(!t||!a||!n)return;let o=t.querySelectorAll("tr").length;const c=n.innerHTML;function i(){let t=0,a=0;e.querySelectorAll(".js-debito").forEach(e=>{t+=parseFloat(e.value)||0}),e.querySelectorAll(".js-credito").forEach(e=>{a+=parseFloat(e.value)||0});const n=e.querySelector("#js-total-debito"),o=e.querySelector("#js-total-credito");n.textContent=t.toFixed(2),o.textContent=a.toFixed(2),t!==a?(n.style.color="red",o.style.color="red"):(n.style.color="green",o.style.color="green")}a.addEventListener("click",(function(){const e=document.createElement("tr");e.innerHTML=`\n            <td>\n                <select name="cuentas[${o}][cuenta_id]" class="formulario__select">\n                    ${c}\n                </select>\n            </td>\n            <td>\n                <input type="text" name="cuentas[${o}][debito]" class="formulario__input js-debito">\n            </td>\n            <td>\n                <input type="text" name="cuentas[${o}][credito]" class="formulario__input js-credito">\n            </td>\n            <td>\n                <button type="button" class="btnEliminarLinea">X</button>\n            </td>\n        `,t.appendChild(e),o++})),e.addEventListener("click",(function(e){if(e.target.classList.contains("btnEliminarLinea")){if(t.querySelectorAll("tr").length<=1)return;e.target.closest("tr").remove(),function(){const e=t.querySelectorAll("tr");e.forEach((e,t)=>{e.querySelectorAll("select, input").forEach(e=>{const a=e.getAttribute("name");if(a){const n=a.replace(/cuentas\[\d+\]/,`cuentas[${t}]`);e.setAttribute("name",n)}})}),o=e.length}(),i()}})),e.addEventListener("input",(function(e){(e.target.classList.contains("js-debito")||e.target.classList.contains("js-credito"))&&i()})),i()}(),function(){if(document.querySelector("#tablaEgresos")){let t;function e(){document.querySelectorAll("#btn_eliminar_egreso").forEach(e=>{e.addEventListener("click",(function(e){!function(e){"btn_eliminar_egreso"===e.currentTarget.id&&function(e){const a=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.egresoId;Swal.fire({title:`¿Desea anular el egreso ${a}?`,text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceder",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&Swal.fire({title:"Razón de anulación",input:"textarea",inputLabel:"Ingrese la razón",inputPlaceholder:"Escriba la razón...",showCancelButton:!0,confirmButtonText:"Anular",cancelButtonText:"Cancelar",inputValidator:e=>{if(!e)return"La razón de anulación es obligatoria"}}).then(e=>{e.isConfirmed&&async function(e,a){try{const n=await fetch("/api/contabilidad/egresos/anular",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,razon_anulacion:a})}),o=await n.json();if("error"===o.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:o.mensaje});Swal.fire({icon:"success",text:o.mensaje}),t.ajax.reload()}catch(e){console.log(e)}}(n,e.value)})})}(e)}(e)}))})}$("#tablaEgresos").dataTable().fnDestroy(),t=$("#tablaEgresos").DataTable({ajax:"/api/contabilidad/egresos",deferRender:!0,retrieve:!0,processing:!0,responsive:!0}),t.on("draw",e)}}(),function(){if(document.querySelector("#tablaTerceros")){let t;function e(){document.querySelectorAll("#btn_eliminar_tercero").forEach(e=>{e.addEventListener("click",(function(e){!function(e){"btn_eliminar_tercero"===e.currentTarget.id&&function(e){const a=e.currentTarget.parentNode.parentNode.parentNode.children[2].textContent,n=e.currentTarget.dataset.terceroId;Swal.fire({title:`Eliminar tercero ${a}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){const a="/api/contabilidad/terceros/eliminar?id="+e;try{const e=await fetch(a),n=await e.json();if("error"===n.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:n.mensaje});Swal.fire({icon:"success",text:n.mensaje}),t.ajax.reload()}catch(e){console.log(e)}}(n)})}(e)}(e)}))})}$("#tablaTerceros").dataTable().fnDestroy(),t=$("#tablaTerceros").DataTable({ajax:"/api/terceros",deferRender:!0,retrieve:!0,processing:!0,responsive:!0}),t.on("draw",e)}}(),function(){if(document.querySelector("#tablaEgresosSimples")){let t;function e(){document.querySelectorAll("#btn_anular_egreso_simple").forEach(e=>{e.addEventListener("click",(function(e){!function(e){const a=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.egresoId;Swal.fire({title:`¿Desea anular el egreso del ${a}?`,text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Proceder",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&Swal.fire({title:"Razón de anulación",input:"textarea",inputLabel:"Ingrese la razón",inputPlaceholder:"Escriba la razón...",showCancelButton:!0,confirmButtonText:"Anular",cancelButtonText:"Cancelar",inputValidator:e=>{if(!e)return"La razón de anulación es obligatoria"}}).then(e=>{e.isConfirmed&&async function(e,a){try{const n=await fetch("/api/contabilidad/egresos-simples/anular",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,razon_anulacion:a})}),o=await n.json();if("error"===o.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:o.mensaje});Swal.fire({icon:"success",text:o.mensaje}),t.ajax.reload()}catch(e){console.log(e)}}(n,e.value)})})}(e)}))})}$("#tablaEgresosSimples").dataTable().fnDestroy(),t=$("#tablaEgresosSimples").DataTable({ajax:"/api/contabilidad/egresos-simples",deferRender:!0,retrieve:!0,processing:!0,responsive:!0}),t.on("draw",e)}}();
//# sourceMappingURL=bundle.js.map
