!function(){if(document.querySelector(".formulario")){const e=document.querySelector('.formulario [type="submit"]');e&&e.addEventListener("click",(function(e){setTimeout(()=>{e.target.disabled=!0,e.target.classList.add("formulario__submit--deshabilitado")},0)}))}}(),function(){const e=document.querySelector(".alerta__exito"),t=document.querySelector(".formulario");if(e){t.style.display="none",setTimeout(()=>{e.remove(),function(){const e=window.location.href;e.includes("/admin/usuarios/")&&(window.location.href="/admin/usuarios");e.includes("/admin/estratos/")&&(window.location.href="/admin/estratos");e.includes("/admin/registrados/")&&(window.location.href="/admin/registrados");e.includes("/admin/cajas/")&&(window.location.href="/admin/cajas")}()},3e3)}}(),function(){if(document.querySelector("#tablaEmitidasPendientes")){let e;$("#tablaEmitidasPendientes").dataTable().fnDestroy(),e=$("#tablaEmitidasPendientes").DataTable({ajax:"/api/emitidas",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),$("#tablaEmitidasPendientes").on("click","#btn_previsualizar",(function(e){!function(e){const t="/api/previsualizar-factura?key="+btoa(e);window.open(t,"_blank")}($(this).attr("data-numero-factura"))}))}}(),function(){const e=document.querySelector("#btnImprimirFacturas");if(e){const n=document.querySelector("#switch"),o=document.querySelector("#btnGenerarFacturas");function t(){Swal.fire({title:"Esta seguro de generar las facturas de este mes?",showDenyButton:!0,confirmButtonText:"Generar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(){o.removeEventListener("click",t),o.classList.add("inicio__boton-generar--inactivo");try{const e=await fetch("/api/generar-facturas-manual"),a=await e.json();console.log(a),o.classList.remove("inicio__boton-generar--inactivo"),o.addEventListener("click",t),Swal.fire({icon:a.type,text:a.msg})}catch(e){console.log(e)}}()})}async function a(){try{const e=await fetch("/api/generar-auto"),s=await e.json();!function(e){const s=document.createElement("INPUT");s.type="checkbox",s.id="checkbox",o.classList.contains("inicio__boton-generar--inactivo")&&o.classList.remove("inicio__boton-generar--inactivo");1==e?(s.checked=!0,o.classList.add("inicio__boton-generar--inactivo"),o.removeEventListener("click",t)):(s.checked=!1,o.addEventListener("click",t));s.onchange=function(){setTimeout(()=>{!async function(e){let t;t=e?1:0;const n=new FormData;n.append("id",1),n.append("auto",t);try{await fetch("/api/generar-auto",{body:n,method:"POST"}),a()}catch(e){}}(s.checked)},300)};const c=document.createElement("DIV");c.classList.add("slider","round"),n.appendChild(s),n.appendChild(c)}(s.auto)}catch(e){console.log(e)}}document.querySelector("#btnEliminarFacturas").addEventListener("click",(function(){Swal.fire({title:"Esta seguro de generar las facturas de este mes?",showDenyButton:!0,confirmButtonText:"Eliminar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(){try{const e=await fetch("/api/eliminar-facturas"),t=await e.json();Swal.fire({icon:t.type,text:t.msg})}catch(e){}}()})})),a(),e.addEventListener("click",(function(){window.open("/api/facturas","_blank")}))}}(),document.addEventListener("DOMContentLoaded",(function(){if(document.querySelector("#cajas")){const a=document.querySelector("#subscriptores"),n=document.querySelector("#subscriptoresVigentes"),o=document.querySelector("#subscriptoresInactivos"),s=document.querySelector("#pagosVigentes"),c=document.querySelector("#fecha"),i=document.querySelector("#ingreso"),r=document.querySelector("#ingresosMensuales"),d=document.querySelector("#totalPagos"),l=document.querySelector("#year"),u=document.querySelector("#mes"),p=document.querySelector("#estratos"),m=document.querySelector("#btnImprimirFacturasFiltradas");function e(){!async function(e){const t=new FormData;t.append("fecha",e);try{const e=await fetch("/api/inicio/ingresos-mensuales",{body:t,method:"POST"}),a=await e.json();r.textContent="$"+a}catch(e){}}(l.value+"-"+u.value)}async function t(e){const t=new FormData;t.append("fecha",e);try{const e=await fetch("/api/inicio/fecha",{body:t,method:"POST"});!function(e){i.textContent="$"+e}(await e.json())}catch(e){}}l.addEventListener("change",e),u.addEventListener("change",e),async function(){try{const e=await fetch("/api/inicio/registrados");!function(e){const{registrados:t,registrados_activos:c,registrados_inactivos:i,pagos_vigentes:r,ingresos:l}=e;a.textContent=t,n.textContent=c,o.textContent=i,s.textContent=r,d.textContent="$"+l}(await e.json())}catch(e){}}(),function(){const e=(new Date).toISOString().slice(0,10);c.value=e,t(e)}(),e(),async function(){const e=location.origin+"/api/estratos-all";try{const a=await fetch(e),n=await a.json();t=n,console.log(t),t.forEach(e=>{const t=document.createElement("OPTION");t.value=e.id,t.textContent=e.estrato,p.appendChild(t)})}catch(e){console.log(e)}var t}(),m.addEventListener("click",(function(e){const t=p.value;if(0==t)Swal.fire({icon:"error",text:"Porfavor seleccione un estrato"});else{const e="/api/facturas?estratos-key="+btoa(t);window.open(e,"_blank")}})),c.addEventListener("change",(function(e){t(e.target.value)}))}})),function(){if(document.querySelector("#estrato")){const s=document.querySelector("#tarifa_plena"),c=document.querySelector("#porcentaje_subsidio"),i=document.querySelector("#subsidio"),r=document.querySelector("#copago"),d=document.querySelector("#porcentaje_acu"),l=document.querySelector("#subsidio_acu"),u=document.querySelector("#copago_acu"),p=document.querySelector("#tarifa_plena_acu"),m=document.querySelector("#porcentaje_alc"),_=document.querySelector("#subsidio_alc"),f=document.querySelector("#copago_alc"),g=document.querySelector("#tarifa_plena_alc"),b=document.querySelector("#porcentaje_aseo"),h=document.querySelector("#subsidio_aseo"),y=document.querySelector("#copago_aseo"),S=document.querySelector("#tarifa_plena_aseo"),C=document.querySelector("#ajuste"),L=document.querySelector("#porcentaje_ajuste");function e(e){const t=e.target.value;let a=parseFloat(t.replace(/,/g,""));isNaN(a)&&(a="");const n=a.toLocaleString("en");e.target.value=n}function t(){a(d.value/100,l,u,p),a(m.value/100,_,f,g),a(b.value/100,h,y,S)}function a(e,t,a,n){const i=s.value,r=c.value/100;if(""!=i&&r>=0&&e>=0){const s=parseFloat(i.replace(/,/g,""));o(s*r*e,1*(s*(1-r)*e).toFixed(2),t,a,n,(s*e).toLocaleString("en"))}else t.value=0,a.value=0,n.value=0}function n(){const e=s.value,t=parseFloat(c.value/100);if(""!=e&&t>=0){const a=parseFloat(e.replace(/,/g,""));o(a*t,1*(a*(1-t)).toFixed(2),i,r)}else i.value="",r.value=""}function o(e,t,a,n,o=[],s=""){""!=s&&(o.value=s);const c=e.toLocaleString("en"),i=t.toLocaleString("en");a.value=c,n.value=i}s.addEventListener("input",(function(a){e(a),n(),t(),C.value="",L.value=""})),c.addEventListener("input",(function(e){const a=parseFloat(e.target.value);(a<0||a>100)&&(e.target.value=""),n(),t(),C.value="",L.value=""})),d.addEventListener("input",(function(e){(1*e.target.value<0||1*e.target.value>100)&&(e.target.value="");a(e.target.value/100,l,u,p)})),m.addEventListener("input",(function(e){(1*e.target.value<0||1*e.target.value>100)&&(e.target.value="");a(e.target.value/100,_,f,g)})),b.addEventListener("input",(function(e){(1*e.target.value<0||1*e.target.value>100)&&(e.target.value="");a(e.target.value/100,h,y,S)})),L.addEventListener("input",(function(){(1*L.value<0||1*L.value>100)&&(L.value="");if(""!=r.value&&""!=L.value&&0!=r.value){const e=parseFloat(r.value.replace(/,/g,"")),t=(L.value/100*e).toFixed(2);C.value=parseFloat(t).toLocaleString("en")}else C.value="",L.value=""})),C.addEventListener("input",(function(t){!function(){if(""!=r.value&&""!=C.value&&0!=r.value){const e=parseFloat(C.value.replace(/,/g,"")),t=parseFloat(r.value.replace(/,/g,""));if(e>t)return C.value="",void(L.value="");const a=1*(100*e/t).toFixed(2);L.value=a}else C.value="",L.value=""}(),e(t)}))}}(),function(){if(document.querySelector("#tablaEstratos")){let a;function e(){document.querySelectorAll("#btn_info_estrato").forEach(e=>{e.addEventListener("click",(function(e){!async function(e){const t="/api/estratos/info?id="+e.currentTarget.dataset.estratoId;try{const e=await fetch(t),a=await e.json();if("error"==a.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:a.mensaje});!function(e){const t=document.createElement("DIV");t.classList.add("modal"),t.innerHTML=`\n                <div class="modal__informacion" id="info">\n                    <h3>Información del Estrato </h3>\n                    \n                    <ul class="modal__lista">\n                         <li class="modal__elemento modal__elemento--grid">\n                           \n                            <p class="modal__info">Estrato: <span>${e.estrato}</span></p>\n                            <p class="modal__info">Año Vigente: <span>${e.year}</span></p>\n                            <p class="modal__info">Tarifa Plena: <span>${parseFloat(e.tarifa_plena).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Número de Facturas Vencidas: <span>${e.facturas_vencidas}</span></p>\n        \n                         </li>\n                   \n\n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Subsidio: <span>${e.porcentaje_subsidio}%</span></p>\n                            <p class="modal__info">Porcentaje Copago: <span>${e.porcentaje_copago}%</span></p>\n                            <p class="modal__info">Subsidio: <span>${parseFloat(e.subsidio).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Copago: <span>${parseFloat(e.copago).toLocaleString("en")}</span></p>\n                         </li>\n                        \n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Acueducto: <span>${parseFloat(e.porcentaje_acu).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Acueducto: <span>${parseFloat(e.tarifa_plena_acu).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Subsidio Acueducto: <span>${parseFloat(e.subsidio_acu).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Copago Acueducto : <span>${parseFloat(e.copago_acu).toLocaleString("en")}</span></p>\n                         </li>\n                         \n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Alcantarillado: <span>${parseFloat(e.porcentaje_alc).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Alcantarillado: <span>${parseFloat(e.tarifa_plena_alc).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Subsidio Alcantarillado: <span>${parseFloat(e.subsidio_alc).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Copago Alcantarillado : <span>${parseFloat(e.copago_alc).toLocaleString("en")}</span></p>\n                         </li>\n                         \n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Aseo: <span>${parseFloat(e.porcentaje_aseo).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Aseo: <span>${parseFloat(e.tarifa_plena_aseo).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Subsidio Aseo: <span>${parseFloat(e.subsidio_aseo).toLocaleString("en")}</span></p>\n                            <p class="modal__info">Valor Copago Aseo : <span>${parseFloat(e.copago_aseo).toLocaleString("en")}</span></p>\n                         </li>\n                         <li class="modal__elemento modal__elemento--grid">\n                            <p class="modal__info">Porcentaje Ajuste: <span>${parseFloat(e.porcentaje_ajuste).toLocaleString("en")}%</span></p>\n                            <p class="modal__info">Tarifa Plena Ajuste: <span>${parseFloat(e.ajuste).toLocaleString("en")}</span></p>\n                           \n                         </li>\n                         \n                        \n                    </ul>\n\n                    <div class="modal__opciones">\n                      \n             \n                      \n                        <button type="button" class="modal__cerrar-modal">Cerrar</button>\n                    </div>\n                    \n                </div>\n            `,setTimeout(()=>{document.querySelector("#info").classList.add("modal__informacion--animar")},10),t.addEventListener("click",(function(e){if(e.preventDefault(),e.target.classList.contains("modal__cerrar-modal")){document.querySelector("#info").classList.add("modal__informacion--cerrar"),setTimeout(()=>{t.remove()},500)}})),document.querySelector(".dashboard__contenedor").appendChild(t)}(a)}catch(e){console.log(e)}}(e)}))});document.querySelectorAll("#btn_eliminar_estrato").forEach(e=>{e.addEventListener("click",(function(e){t(e)}))})}function t(e){const t=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.estratoId;Swal.fire({title:`Esta seguro que desea eliminar el estrato ${t}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){url="/api/estratos/eliminar?id="+e;try{const e=await fetch(url),t=await e.json();if("error"==t.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:t.mensaje});Swal.fire({icon:"success",text:t.mensaje}),a.ajax.reload()}catch(e){console.log(e)}}(n)})}$("#tablaEstratos").on("click","#btn_eliminar_estrato",(function(e){t(e)})),$("#tablaEstratos").dataTable().fnDestroy(),a=$("#tablaEstratos").DataTable({ajax:"/api/estratos",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),a.on("draw",e)}}(),function(){if(document.querySelector("#tablaPagos")){let e;$("#tablaPagos").dataTable().fnDestroy(),e=$("#tablaPagos").DataTable({ajax:"/api/lista-pagos",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),$("#tablaPagos").on("click","#btn_previsualizar",(function(e){!function(e){const t="/api/previsualizar-pago?key="+btoa(e);window.open(t,"_blank")}($(this).attr("data-numero-pago"))})),$("#tablaPagos").on("click","#btn_anular",(function(t){var a;a=$(this).attr("data-numero-pago"),Swal.fire({title:`Esta seguro que desea anular el pago # ${a}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(t){const a=new FormData;a.append("numero_pago",t);try{const t=await fetch("/api/anular-pago",{body:a,method:"POST"}),n=await t.json();if(console.log(n),"error"==n.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:n.mensaje});Swal.fire({icon:"success",text:n.mensaje}),e.ajax.reload()}catch(e){}}(a)})}))}}(),function(){if(document.querySelector("#contenedorPagar")){const t=document.querySelector("#numero_factura"),a=document.querySelector("#pagarFacturas"),n=document.querySelector("#guardarPagos"),o=document.querySelector("#totalFacturas"),s=document.querySelector("#totalRecaudo");let c,i=[];function e(){for(;a.firstChild;)a.removeChild(a.firstChild)}!async function(){try{const n=await fetch("/api/facturas-por-pagar"),r=await n.json();c=r,t.addEventListener("input",(function(n){!function(n){const r=n.target.value,d=c.find(e=>e.numero_factura===r);d&&(t.value="",function(t){if(i.find(e=>e.id===t.id))setTimeout(()=>{Swal.fire("Error","La Factura ya fue agregada a la fila de pagos","error")},1);else if(1==t.pagado)setTimeout(()=>{Swal.fire("Error","La Factura ya ha sido cancelada","error")},1);else if(1==t.combinado)setTimeout(()=>{Swal.fire("Error","La Factura ha sido combinada","error")},1);else{Swal.fire({position:"top-end",icon:"success",title:"Factura agregada a la pila",showConfirmButton:!1,timer:1500});const{id:n,numero_factura:c,registrado_nombre:r,estrato:d,mes_facturado:l,copago:u,ajuste:p,saldo_anterior:m}=t;i.unshift({numero_factura:c,subscriptor:r,estrato:d,mes_facturado:l,copago:u,ajuste:p,saldo_anterior:m,id:n});const _=document.createElement("TABLE");_.classList.add("table"),e();let f=0,g=0;i.forEach(e=>{const{numero_factura:t,subscriptor:a,estrato:n,mes_facturado:o,copago:s,ajuste:c,saldo_anterior:i}=e,r=document.createElement("TR");r.classList.add("table__tr");const d=document.createElement("TD");d.classList.add("table__td"),d.textContent="#"+t;const l=document.createElement("TD");l.classList.add("table__td"),l.innerHTML='<span class="table__span">Cliente:&nbsp; </span>&nbsp; '+a;const u=document.createElement("TD");u.classList.add("table__td"),u.innerHTML='<span class="table__span">Estrato:&nbsp; </span>&nbsp; '+n;const p=document.createElement("TD");p.classList.add("table__td"),p.innerHTML='<span class="table__span">Mes Facturado:&nbsp; </span>&nbsp; '+o;let m=parseFloat(s)+parseFloat(i)-parseFloat(c);const b=document.createElement("TD");b.classList.add("table__td"),b.innerHTML=' <span class="table__span">Monto:&nbsp; </span>$ '+m.toLocaleString("en"),r.appendChild(d),r.appendChild(l),r.appendChild(u),r.appendChild(p),r.appendChild(b),_.appendChild(r),f+=m,g+=1}),o.textContent=g,s.textContent="$"+f.toLocaleString("en"),a.appendChild(_)}}(d))}(n)}))}catch(e){}}(),n.addEventListener("click",(function(){i.length>0?Swal.fire({title:`Esta seguro que desea subir ${o.textContent} Pagos por ${s.textContent}`,icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&async function(){const t=new FormData,a=i.map(e=>e.id);t.append("pagos",JSON.stringify(a));try{const a=await fetch("/api/subir-pagos",{body:t,method:"POST"}),n=await a.json();"error"==n.tipo?Swal.fire({icon:"error",title:"Oops",text:n.mensaje}):(e(),o.textContent=0,s.textContent="$0",i=[],Swal.fire({icon:"success",text:n.mensaje}))}catch(e){}}()}):Swal.fire("Error","Debe agregar al menos una factura","error")}))}}(),function(){if(document.querySelector("#caja")){document.querySelector("#efectivo_inicial").addEventListener("input",(function(e){!function(e){const t=e.target.value;let a=parseFloat(t.replace(/,/g,""));isNaN(a)&&(a="");const n=a.toLocaleString("en");e.target.value=n}(e)}))}}(),function(){if(document.querySelector("#tablaCajasPagos")){let e;const t=new URL(window.location),a=new URLSearchParams(t.search).get("id");document.querySelector("#tablaCajasPagos");Number.isInteger(parseInt(a))?($("#tablaCajasPagos").dataTable().fnDestroy(),e=$("#tablaCajasPagos").DataTable({ajax:"/api/cajas/pagos?id="+a,deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0})):window.location.href="/admin/cajas"}}(),function(){if(document.querySelector("#tablaCajas")){let t;function e(e){Swal.fire({title:"Esta Seguro de Cerrar esta Caja?",text:"Esta acción no se puede deshacer",icon:"warning",showDenyButton:!0,confirmButtonText:"Seguro",denyButtonText:"Cancelar"}).then(a=>{a.isConfirmed&&async function(e){const a=new FormData;a.append("id",e);try{const e="/api/cajas/cerrar",n=await fetch(e,{body:a,method:"POST"}),o=await n.json();if("success"==o.tipo){if("error"==o.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:o.mensaje});Swal.fire({icon:"success",text:o.mensaje}),t.ajax.reload()}}catch(e){console.log(e)}}(e)})}$("#tablaCajas").on("click","#estadoCaja",(function(t){e($(this).data("cajaId"))})),$("#tablaCajas").dataTable().fnDestroy(),t=$("#tablaCajas").DataTable({ajax:"/api/cajas",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),t.on("draw",(function(){const t=document.querySelector("#estadoCaja");t&&t.addEventListener("dblclick",(function(t){e(t.target.dataset.cajaId)}))}))}}(),function(){const e=document.querySelector("#facturas");if(e){const n=new URL(window.location),o=new URLSearchParams(n.search).get("id"),s=document.querySelector("#cliente");async function t(){const t=new FormData;t.append("id",o);try{const n="/api/facturas-registrado",o=await fetch(n,{method:"POST",body:t}),c=await o.json();c&&(function(e){const t=document.querySelector("#deuda");t.classList=[],t.classList.add("deuda__valor"),0==e?t.classList.add("deuda__valor--pagado"):t.classList.add("deuda__valor--vencido");t.textContent="$ "+e.toLocaleString("en")}(c.deuda),function(t){const n=document.createElement("TABLE");n.classList.add("table"),t.forEach(e=>{const{id:t,numero_factura:o,fecha_emision:c,periodo_fin:i,periodo_inicio:r,copago:d,pagado:l,ajuste:u,combinado:p,saldo_anterior:m}=e,_=(new Date).getMonth()+1,f=c.split("-"),g=_-parseFloat(f[1]),b=document.createElement("TR");b.classList.add("table__tr"),b.onclick=function(t){!function(e){const t=document.querySelector(".table__seleccion");t&&t.classList.remove("table__seleccion");e.currentTarget.classList.add("table__seleccion")}(t),function(e){const{id:t,numero_factura:n,fecha_emision:o,estrato:c,periodo_inicio:i,periodo_fin:r,copago:d,ajuste:l,pagado:u,saldo_anterior:p,combinado:m}=e;!function(){const e=document.querySelector("#actions");for(;e.firstChild;)e.removeChild(e.firstChild)}();const _=document.querySelector("#actions"),f=document.createElement("DIV");f.classList.add("actions__contenedor");document.createElement("DIV").classList.add("actions__info");const g=document.createElement("DIV");g.classList.add("registrado__datos");const b=document.createElement("SPAN");b.classList.add("registrado__label"),b.textContent="Cliente";const h=document.createElement("P");h.classList.add("registrado__dato"),h.textContent=s.textContent;const y=document.createElement("DIV");y.classList.add("registrado__datos");const S=document.createElement("SPAN");S.classList.add("registrado__label"),S.textContent="Estrato";const C=document.createElement("P");C.classList.add("registrado__dato"),C.textContent=c;const L=document.createElement("DIV");L.classList.add("registrado__datos");const v=document.createElement("SPAN");v.classList.add("registrado__label"),v.textContent="Periodo";const E=document.createElement("P");E.classList.add("registrado__dato"),E.innerHTML=`${i} &nbsp;- &nbsp;  ${r}`;const w=document.createElement("DIV");w.classList.add("registrado__datos");const x=document.createElement("SPAN");x.classList.add("registrado__label"),x.textContent="Monto ";const T=parseFloat(d)+parseFloat(p)-parseFloat(l),j=document.createElement("P");j.classList.add("registrado__dato"),j.textContent="$ "+T.toLocaleString("en"),g.appendChild(b),g.appendChild(h),y.appendChild(S),y.appendChild(C),L.appendChild(v),L.appendChild(E),w.appendChild(x),w.appendChild(j),f.appendChild(g),f.appendChild(y),f.appendChild(L),f.appendChild(w),_.appendChild(f);const q=document.createElement("DIV");q.classList.add("actions__botones");const P=document.createElement("SPAN");if(P.classList.add("actions__boton"),P.onclick=function(){!async function(e){const t="/api/previsualizar-factura?key="+btoa(e);window.open(t,"_blank")}(n)},P.textContent="Previzualizar",0==u&&0==m){const t=document.createElement("SPAN");t.classList.add("actions__boton"),t.textContent="Pago Efectivo",t.id="btnPagar";const n=document.createElement("SPAN");n.classList.add("actions__boton"),n.textContent="transferencia",n.id="btnBanco",t.onclick=function(){n.style.display="none",t.style.display="none",a(e,1,t,n)},n.onclick=function(){n.style.display="none",t.style.display="none",a(e,0,t,n)},q.appendChild(t),q.appendChild(n)}q.appendChild(P),_.appendChild(q)}(e)};const h=document.createElement("TD");h.classList.add("table__td"),h.textContent="#"+o;const y=document.createElement("TD");y.classList.add("table__td"),y.innerHTML='<span class="table__span">Emitida:&nbsp; </span>&nbsp; '+c;const S=document.createElement("TD");S.classList.add("table__td"),S.innerHTML=`<span class="table__span">Periodo:&nbsp; </span>&nbsp; ${r} &nbsp; - &nbsp;${i}`;const C=parseFloat(d)+parseFloat(m)-parseFloat(u),L=document.createElement("TD");L.classList.add("table__td"),L.innerHTML=' <span class="table__span">Monto:&nbsp; </span>$ '+parseFloat(C).toLocaleString("en");const v=document.createElement("TD");v.classList.add("table__td"),v.innerHTML=g>0&&0==l?' <span class="table__boton table__boton--vencida">Impaga</span>':` <span class="table__boton table__boton--${1==l?"pagado":"impaga"}">${1==l?"Pagado":"Impaga"}</span>`,1==p&&(v.innerHTML=' <span class="table__boton table__boton--vencida">Combinada</span>'),b.appendChild(h),b.appendChild(y),b.appendChild(S),b.appendChild(L),b.appendChild(v),n.appendChild(b)}),e.appendChild(n)}(c.facturas))}catch(e){console.log(e)}}function a(a,n,o,c){const{id:i,copago:r,periodo_inicio:d,periodo_fin:l,numero_factura:u}=a,p=document.createElement("DIV");p.classList.add("registrado");const m=document.createElement("DIV");m.classList.add("registrado__datos");const _=document.createElement("SPAN");_.classList.add("registrado__label"),_.textContent="Metodo de Pago:";const f=document.createElement("P");f.classList.add("registrado__dato"),f.textContent=1==n?"Efectivo":"Transferencia";const g=document.createElement("DIV");g.classList.add("registrado__datos");const b=document.createElement("SPAN");b.classList.add("registrado__label"),b.textContent="Cliente:";const h=document.createElement("P");h.classList.add("registrado__dato"),h.textContent=s.textContent;const y=document.createElement("DIV");y.classList.add("registrado__datos");const S=document.createElement("SPAN");S.classList.add("registrado__label"),S.textContent="Periodo:";const C=document.createElement("P");C.classList.add("registrado__dato"),C.innerHTML=`${d} &nbsp;- &nbsp;  ${l}`;const L=document.createElement("DIV");L.classList.add("registrado__datos");const v=document.createElement("SPAN");v.classList.add("registrado__label"),v.textContent="Monto: ";const E=document.createElement("P");E.classList.add("registrado__dato"),E.textContent="$ "+parseFloat(r).toLocaleString("en"),m.appendChild(_),m.appendChild(f),g.appendChild(b),g.appendChild(h),y.appendChild(S),y.appendChild(C),L.appendChild(v),L.appendChild(E),p.appendChild(m),p.appendChild(g),p.appendChild(y),p.appendChild(L),Swal.fire({title:"Confirme La información",html:p,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(a=>{a.isConfirmed?async function(a,n,o,s){const c=new FormData;c.append("id",a),c.append("metodo",n);try{const a=await fetch("/api/pagar",{body:c,method:"POST"}),n=await a.json();if("error"==n.tipo)Swal.fire({icon:"error",title:"Oops",text:n.mensaje});else{Swal.fire({icon:"success",text:n.mensaje});const a=document.querySelector("body"),o=document.createElement("input");for(o.type="hidden",o.id="confirmacionPago",a.appendChild(o);e.firstChild;)e.removeChild(e.firstChild);document.querySelector("#btnPagar").remove(),t()}}catch(e){}}(i,n):(o.style.display="block",c.style.display="block")})}t()}}(),function(){if(document.querySelector("#tablaRegistrados")){let a;function e(){document.querySelectorAll("#btn_eliminar_registrado").forEach(e=>{e.addEventListener("click",(function(e){t(e)}))})}function t(e){"btn_eliminar_registrado"==e.currentTarget.id&&function(e){const t=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,n=e.currentTarget.dataset.registradoId;Swal.fire({title:`Esta seguro que desea eliminar el estrato ${t}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){url="/api/registrados/eliminar?id="+e;try{const e=await fetch(url),t=await e.json();if("error"==t.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:t.mensaje});Swal.fire({icon:"success",text:t.mensaje}),a.ajax.reload()}catch(e){console.log(e)}}(n)})}(e)}$("#tablaRegistrados").on("click","#btn_eliminar_registrado",(function(e){t(e)})),$("#tablaRegistrados").dataTable().fnDestroy(),a=$("#tablaRegistrados").DataTable({ajax:"/api/registrados",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),a.on("draw",e)}}(),function(){const e=document.querySelector("#pagos");if(e){const a=new URL(window.location),n=new URLSearchParams(a.search).get("id");document.querySelector("#cliente"),document.querySelector("#actions");async function t(){document.querySelector("#confirmacionPago")&&document.querySelector("#confirmacionPago").remove();const t=new FormData;t.append("id",n);try{const a="/api/pagos",n=await fetch(a,{method:"POST",body:t}),o=await n.json();o&&function(t){for(;e.firstChild;)e.removeChild(e.firstChild);const a=document.createElement("TABLE");a.classList.add("table"),t.forEach(e=>{const{id:t,numero_factura:n,fecha_pago:o,periodo_fin:s,periodo_inicio:c,monto:i,numero_pago:r,estado:d}=e,l=document.createElement("TR");l.classList.add("table__tr"),l.onclick=function(t){!function(e){const t=document.querySelector(".table__seleccion");t&&t.classList.remove("table__seleccion");e.currentTarget.classList.add("table__seleccion")}(t),function(e){const{id:t,numero_factura:a,numero_pago:n,estrato:o,metodo:s,periodo_inicio:c,periodo_fin:i,monto:r,recaudador:d,factura_id:l}=e;!function(){const e=document.querySelector("#payments");for(;e.firstChild;)e.removeChild(e.firstChild)}();const u=document.querySelector("#payments"),p=document.createElement("DIV");p.classList.add("actions__contenedor");document.createElement("DIV").classList.add("actions__info");const m=document.createElement("DIV");m.classList.add("registrado__datos");const _=document.createElement("SPAN");_.classList.add("registrado__label"),_.textContent="Recaudador";const f=document.createElement("P");f.classList.add("registrado__dato"),f.textContent=d;const g=document.createElement("DIV");g.classList.add("registrado__datos");const b=document.createElement("SPAN");b.classList.add("registrado__label"),b.textContent="Periodo";const h=document.createElement("P");h.classList.add("registrado__dato"),h.innerHTML=`${c} &nbsp;- &nbsp;  ${i}`;const y=document.createElement("DIV");y.classList.add("registrado__datos");const S=document.createElement("SPAN");S.classList.add("registrado__label"),S.textContent="Monto ";const C=document.createElement("P");C.classList.add("registrado__dato"),C.textContent="$ "+r;const L=document.createElement("DIV");L.classList.add("registrado__datos");const v=document.createElement("SPAN");v.classList.add("registrado__label"),v.textContent="Metodo ";const E=document.createElement("P");E.classList.add("registrado__dato"),E.textContent=1==s?"Efectivo":"Transferencia",m.appendChild(_),m.appendChild(f),g.appendChild(b),g.appendChild(h),y.appendChild(S),y.appendChild(C),L.appendChild(v),L.appendChild(E),p.appendChild(m),p.appendChild(g),p.appendChild(y),p.appendChild(L),u.appendChild(p);const w=document.createElement("DIV");w.classList.add("actions__botones");const x=document.createElement("SPAN");x.classList.add("actions__boton"),x.onclick=function(){!async function(e){const t="/api/previsualizar-pago?key="+btoa(e);window.open(t,"_blank")}(l)},x.textContent="Previzualizar",w.appendChild(x),u.appendChild(w)}(e)};const u=document.createElement("TD");u.classList.add("table__td"),u.textContent="#"+n;const p=document.createElement("TD");p.classList.add("table__td"),p.innerHTML='<span class="table__span">Fecha de Pago:&nbsp; </span>&nbsp; '+o;const m=document.createElement("TD");m.classList.add("table__td"),m.innerHTML=`<span class="table__span">Periodo:&nbsp; </span>&nbsp; ${c} &nbsp; - &nbsp;${s}`;const _=document.createElement("TD");_.classList.add("table__td"),_.innerHTML=' <span class="table__span">Monto:&nbsp; </span>$ '+i;const f=document.createElement("TD");if(f.classList.add("table__td"),f.innerHTML=' <span class="table__span">Pago #&nbsp; </span> '+r,l.appendChild(u),l.appendChild(p),l.appendChild(m),l.appendChild(_),l.appendChild(f),0==d){console.log("asdf");const e=document.createElement("TD");e.classList.add("table__td"),e.innerHTML='<span class="table__boton table__boton--vencida">Anulado</span>',l.appendChild(e)}a.appendChild(l)}),e.appendChild(a)}(o)}catch(e){console.log(e)}}document.querySelector("body").addEventListener("click",(function(){document.querySelector("#confirmacionPago")&&t()})),t()}}(),function(){const e=document.querySelector("#tablaUsuarios");if(e){let n;function t(){document.querySelectorAll("#btn_eliminar_usuario").forEach(e=>{e.addEventListener("click",(function(e){a(e)}))})}function a(e){const t=e.currentTarget.parentNode.parentNode.parentNode.children[1].textContent,a=e.currentTarget.dataset.usuarioId;Swal.fire({title:`Esta seguro que desea eliminar a  ${t}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){url="/api/usuarios/eliminar?id="+e;try{const e=await fetch(url),t=await e.json();if("error"==t.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:t.mensaje});Swal.fire({icon:"success",text:t.mensaje}),n.ajax.reload()}catch(e){console.log(e)}}(a)})}e.addEventListener("click",(function(e){!function(e){"btn_cambiar_estado"==e.target.id&&function(e){const t=e.target.dataset.estadoActual,a=e.target.parentNode.parentNode.children[1].textContent,o=e.target.dataset.usuarioId;let s="";s=1==t?"Esta seguro que desea desactivar a":"Esta seguro que desea activar a";Swal.fire({title:`${s}  ${a}?`,text:"Esta accion no se puede deshacer",icon:"question",showDenyButton:!0,confirmButtonText:"Aceptar",denyButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&async function(e){url="/api/usuarios/editar-estado?id="+e;try{const e=await fetch(url),t=await e.json();if("error"==t.tipo)return void Swal.fire({icon:"error",title:"Oops...",text:t.mensaje});Swal.fire({icon:"success",title:t.mensaje}),n.ajax.reload()}catch(e){console.log(e)}}(o)})}(e)}(e)})),$("#tablaUsuarios").on("click","#btn_eliminar_usuario",(function(e){a(e)})),$("#tablaUsuarios").dataTable().fnDestroy(),n=$("#tablaUsuarios").DataTable({ajax:"/api/usuarios",deferRender:!0,retrieve:!0,proccesing:!0,responsive:!0}),n.on("draw",t)}}();
//# sourceMappingURL=bundle.js.map
